# AI Coding Agent Configuration - Version 2.0 (Multi-Provider Support)

# LLM Provider Selection
# Options: "ollama" (self-hosted), "claude" (Anthropic API), "hybrid" (smart routing)
LLM_PROVIDER=ollama

# Ollama Configuration (for "ollama" or "hybrid" mode)
OLLAMA_BASE_URL=http://localhost:11434
MODEL_NAME=qwen2.5-coder:1.5b

# Claude/Anthropic Configuration (for "claude" or "hybrid" mode)
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=your-api-key-here

# Model selection (options: claude-3-haiku-20240307, claude-3-5-sonnet-20241022)
CLAUDE_MODEL=claude-3-haiku-20240307

# Model Parameters
TEMPERATURE=0.1
MAX_TOKENS=2000

# Memory Configuration
MAX_HISTORY_LENGTH=10

# CLI Configuration
CLI_THEME=monokai
STREAM_OUTPUT=true

# For cloud deployment (change OLLAMA_BASE_URL to your AWS server)
# OLLAMA_BASE_URL=https://ai-server.yourcompany.com

# Hybrid Mode Configuration (Smart Routing)
# Priority 1: Ollama keywords → Ollama (fast, no rate limits for simple ops)
# OLLAMA_KEYWORDS=git,commit,branch,status,diff,log,checkout,list files,read file,search code,write file
#
# Priority 2: Claude keywords → Claude/Gemini (advanced reasoning for complex queries)
# CLAUDE_KEYWORDS=architecture,design pattern,refactor,optimize,security,best practice,review,compare
#
# Priority 3: Default → Gemini (everything else)
#
# Example routing in hybrid mode:
# - "git status" → Ollama (matches git keyword)
# - "refactor this code" → Gemini/Claude (matches refactor keyword)
# - "explain this function" → Gemini (default)

# Tool Retry Configuration (Phase 2 - Error Recovery)
# Maximum number of retry attempts for tool execution
TOOL_MAX_RETRIES=3
# Exponential backoff multiplier (wait time doubles each retry)
TOOL_RETRY_BACKOFF=2.0
# Initial delay in seconds before first retry
TOOL_RETRY_INITIAL_DELAY=1.0
# Maximum delay in seconds between retries
TOOL_RETRY_MAX_DELAY=60.0

# Task Planning Configuration (Phase 2 - Multi-Step Planning)
# Enable automatic task planning for complex queries
ENABLE_PLANNING=true
# Minimum query complexity (1-10) to trigger planning
PLANNING_MIN_COMPLEXITY=3
# Maximum number of steps allowed in a plan
PLANNING_MAX_STEPS=10
# Show step-by-step execution progress
PLANNING_VERBOSE=true
# Auto-approve plans without user review (false = user must approve)
PLANNING_AUTO_APPROVE=false

# Git Integration Tools (Phase 3 - Version Control)
# Enable git tools for version control operations
# Provides: git_status, git_diff, git_commit, git_branch, git_log
ENABLE_GIT_TOOLS=true

# ============================================================================
# PostgreSQL + pgvector Storage Configuration (Dual-Mode RAG)
# ============================================================================

# Enable PostgreSQL storage backend (false = use FAISS, true = use PostgreSQL)
ENABLE_POSTGRES_STORAGE=false

# Database Connection
# Format: postgresql://username:password@host:port/database
# For local Docker setup (see docker-compose.yml and docs/POSTGRES_SETUP.md):
DATABASE_URL=postgresql://ai_agent_user:dev_password_change_in_production@localhost:5432/ai_agent

# Connection Pool Settings
DB_POOL_SIZE=10           # Minimum number of connections in pool
DB_MAX_OVERFLOW=20        # Maximum overflow connections
DB_CONNECTION_TIMEOUT=30  # Connection timeout in seconds

# pgvector Index Configuration
PGVECTOR_INDEX_TYPE=hnsw              # Index type: hnsw or ivfflat
PGVECTOR_HNSW_M=16                    # HNSW parameter: number of connections per layer
PGVECTOR_HNSW_EF_CONSTRUCTION=64      # HNSW parameter: size of dynamic candidate list

# Batch Crawling Configuration
BATCH_CRAWL_MAX_CONCURRENT=5          # Max concurrent crawls in batch operations
BATCH_CRAWL_SKIP_DUPLICATES=true      # Skip already-crawled URLs

# Quick Start:
# 1. Start PostgreSQL:   docker-compose up -d postgres
# 2. Test connection:    python scripts/test_postgres_connection.py
# 3. Enable in app:      Set ENABLE_POSTGRES_STORAGE=true
# 4. Run application:    python main.py
#
# Documentation: docs/POSTGRES_SETUP.md
# Architecture:  docs/ARCHITECTURE.md (PostgreSQL section)
